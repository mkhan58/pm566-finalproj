---
title: "PM566 Final Project"
author: "Misha Khan"
output: 
    html_document:
        toc: TRUE
        toc_float: TRUE
---

This is my PM566 Final Project website.

<br>

# Question: What is crime like in Los Angeles from 2020-2021 (in terms of highest crime month, victim demographics, and top crimes)?

```{r setup, message=FALSE, echo=FALSE, warning=FALSE}
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)

# Initialize code chunk options
opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  eval=TRUE,
  echo = TRUE,
  cache = FALSE,
  fig.width = 7, 
  fig.align = 'center',
  fig.asp = 0.618,
  out.width = "700px")

```

```{r}
source("crime_presentation_eda.R")

#Viz 1: Months with the Highest Crime in the Top 5 Areas
month_crime = plot_ly(ncrimesdate, x = ~Month, y = ~n, color = ~Area, type = "bar")
month_crime <- month_crime %>% layout(yaxis = list(title = 'Count'), barmode = 'stack')
month_crime <- month_crime %>% layout(title = "Months with the Highest Crime in the Top 5 Areas")
month_crime_plotly <- ggplotly(month_crime)


#Viz 2: Most Common Crimes in Top Areas
top_crime <- ncrimes %>% 
  plot_ly(x = ~Crime, y = ~n,
          type = 'scatter',
          mode = 'markers',
          color = ~Area,
          sizes = c(5, 70),
          marker = list(sizemode='diameter', opacity=0.5))
top_crime <- top_crime %>% layout(title = "Most Common Crime in Top Areas")
top_crime_plotly <- ggplotly(top_crime)


#Viz 3: Area with the Highest Crime Map
central_map <- 
  leaflet(central_top_crimes) %>%  
  addProviderTiles('CartoDB.Positron') %>% 
  addCircles(
    lat = ~Lat, 
    lng = ~Lon,
    label = ~paste0(central_top_crimes$`Crime`),
    color = ~ central.pal(central_top_crimes$`Crime`),
    opacity = 0.5,
    fillOpacity = 1,
    radius = 5
  ) %>%
  addLegend('bottomleft', 
            pal = central.pal,  
            values = central_top_crimes$`Crime`,
            title = 'Central Crime Map', 
            opacity = 1)


#Viz 4: Victim Age and Sex
vict_demo <-plot_ly(victim_demographics, x = ~victim_age_f, color = ~`Victim Sex`) %>%
  add_histogram()
#vict_demo <- vict_demo %>% layout(barmode = "overlay")
vict_demo <- vict_demo %>% layout(title = "Histogram of Victim's Age and Gender",
                                  yaxis = list(
                                    title = "Count"
                                  ),
                                  xaxis = list(
                                    title = "Age"
                                  ))
vict_demo_plotly <- ggplotly(vict_demo)


```

## Showcasing plots {.tabset}

### Tab 1

```{r echo=FALSE}
month_crime_plotly 
```  

### Tab 2

```{r echo=FALSE}
top_crime_plotly 
```

### Tab 3
```{r echo=FALSE}
central_map 
```

### Tab 4
```{r echo=FALSE}
vict_demo_plotly
```
## {-}
